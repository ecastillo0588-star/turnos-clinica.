<!-- mis-consultas.html -->
<section id="mc" class="mc">
  <style>
    .mc { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#2b2540; }
    .mc .card { background:#fff; border-radius:14px; box-shadow:0 2px 12px rgba(80,60,160,.10); padding:18px 18px; }
    .mc .title { font-weight:700; font-size:22px; margin:2px 0 14px; color:#381e60; }

    /* Filtros */
    .mc .filters { display:grid; grid-template-columns: repeat(4, minmax(110px, 1fr)) auto; gap:10px; align-items:end; }
    .mc .field label { font-size:12px; color:#6b6480; display:block; margin-bottom:4px; }
    .mc input[type="date"], .mc select { width:100%; background:#f7f9fb; border:1.5px solid #ece5fc; border-radius:8px; padding:8px 10px; color:#4f3b7a; font-size:14px; }
    .mc .btn { background:#7656b0; color:#fff; border:none; border-radius:8px; padding:9px 16px; cursor:pointer; font-weight:600; }
    .mc .btn:hover { background:#6a4bb0; }

    /* KPIs */
    .mc .kpis { display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin:14px 0 10px; }
    .mc .kpi { background:#fff; border-radius:12px; padding:14px 16px; box-shadow:0 2px 10px rgba(60,40,140,.06); }
    .mc .kpi .lbl { font-size:12px; color:#6b6480; }
    .mc .kpi .val { font-size:20px; font-weight:700; color:#381e60; margin-top:4px; }

    /* Charts grid */
    .mc .charts { margin-top:8px; }
    .mc .charts-grid { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
    @media (max-width: 980px) { .mc .charts-grid { grid-template-columns: 1fr; } }

    /* Carta de chart: altura explícita para evitar estiramientos */
    .mc .chart-card { background:#fff; border-radius:14px; box-shadow:0 2px 12px rgba(80,60,160,.10); padding:12px; position:relative; height:320px; }
    .mc .chart-card h4 { margin:4px 8px 8px; font-size:14px; color:#6b6480; font-weight:600; }
    .mc .chart-box { position:relative; height:calc(100% - 28px); }
    .mc .chart-box canvas { position:absolute; inset:0; width:100% !important; height:100% !important; }

    /* Tabla */
    .mc .legend { margin:14px 2px 8px; font-size:13px; color:#6b6480; }
    .mc table { width:100%; border-collapse: collapse; background:#fff; border-radius:12px; overflow:hidden; box-shadow:0 2px 10px rgba(60,40,140,.06); }
    .mc thead th { text-align:left; font-size:12px; color:#6b6480; background:#f7f5fe; padding:10px 12px; }
    .mc tbody td { padding:10px 12px; border-top:1px solid #f1ecff; font-size:13px; }
    .mc tbody tr:hover { background:#faf9ff; }

    /* Empty/debug */
    .mc .empty { font-size:13px; color:#6b6480; padding:10px 2px; }
    .mc details { margin-top:10px; }
    .mc summary { cursor:pointer; color:#5b3ea8; }
    .mc pre { background:#0c0c10; color:#e7e7fb; border-radius:10px; padding:12px; max-height:260px; overflow:auto; }
  </style>

  <div class="card">
    <div class="title">Mis Consultas</div>

    <div class="filters">
      <div class="field">
        <label>Desde</label>
        <input type="date" id="mc-desde" />
      </div>
      <div class="field">
        <label>Hasta</label>
        <input type="date" id="mc-hasta" />
      </div>
      <div class="field">
        <label>Centro</label>
        <select id="mc-centro">
          <option value="">Todos los centros</option>
        </select>
      </div>
      <div class="field">
        <label>Granularidad</label>
        <select id="mc-gran">
          <option value="day">Diaria</option>
          <option value="week">Semanal</option>
          <option value="month">Mensual</option>
        </select>
      </div>
      <button id="mc-refresh" class="btn">Actualizar</button>
    </div>

    <div class="kpis">
      <div class="kpi"><div class="lbl">Atendidos</div><div class="val" id="mc-kpi-consultas">—</div></div>
      <div class="kpi"><div class="lbl">Cobrado</div><div class="val" id="mc-kpi-cobrado">—</div></div>
      <div class="kpi"><div class="lbl">Pendiente</div><div class="val" id="mc-kpi-pendiente">—</div></div>
    </div>

    <div class="charts">
      <div class="charts-grid">
        <div class="chart-card">
          <h4>Atenciones por período</h4>
          <div class="chart-box"><canvas id="mc-chart-timeline"></canvas></div>
        </div>
        <div class="chart-card">
          <h4>Obra social (atendidos)</h4>
          <div class="chart-box"><canvas id="mc-chart-os"></canvas></div>
        </div>
        <div class="chart-card">
          <h4>Atenciones por centro</h4>
          <div class="chart-box"><canvas id="mc-chart-centros"></canvas></div>
        </div>
        <div class="chart-card">
          <h4>Estados</h4>
          <div class="chart-box"><canvas id="mc-chart-estados"></canvas></div>
        </div>
      </div>
    </div>

    <div class="legend" id="mc-legend">—</div>
    <div class="empty" id="mc-empty">—</div>

    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Hora</th>
          <th>Centro</th>
          <th>Paciente</th>
          <th>Estado</th>
          <th style="text-align:right">Copago</th>
          <th style="text-align:right">Pagado</th>
        </tr>
      </thead>
      <tbody id="mc-tbody"></tbody>
    </table>

    <details>
      <summary>Ver debug</summary>
      <pre id="mc-debug-pre">// logs…</pre>
    </details>
  </div>
</section>
