<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gesti√≥n de Asistentes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f7f9fb; margin: 0; }
    .container { max-width: 800px; margin: 36px auto; background: #fff; padding: 28px 22px 20px 22px; border-radius: 18px; box-shadow: 0 2px 8px rgba(80,60,160,.13); }
    h3 { color:#381e60; margin-bottom:22px;}
    .btn { background: #7656b0; color: #fff; border: none; border-radius: 6px; padding: 6px 16px; cursor:pointer; margin: 3px;}
    .btn.primary { background: #7656b0; }
    .btn:hover { background: #7f62b6; }
    input, select, textarea { border: 1px solid #e3d8f6; border-radius: 6px; padding: 5px 8px; font-size:15px; background:#f7f9fb; }
    label { color:#381e60;}
    .muted { color: #6b6480; font-size: 13px; }
    table { width: 100%; border-collapse: collapse; margin-top: 14px; }
    th, td { text-align:left; padding: 10px 8px; }
    th { background: #e7e2fa; color: #381e60; font-size: 16px; }
    td { font-size: 15px; border-bottom: 1px solid #ece5fc; }
    .action-cell { text-align: right; }
    .icon-btn { background: none; border: none; cursor: pointer; padding: 0; margin-left: 6px;}
    .icon-btn svg { vertical-align: middle; width: 22px; height: 22px;}
    .icon-btn.edit-btn svg { stroke: #7656b0; }
    .icon-btn.delete-btn svg { stroke: #B00020; }
    .icon-btn.centro-btn svg { stroke: #00796B; }
    .icon-btn.desasociar-btn svg { stroke: #B00020; }
    .icon-btn.edit-btn:hover svg { stroke: #381e60; }
    .icon-btn.delete-btn:hover svg { stroke: #8e0c2f; }
    .icon-btn.centro-btn:hover svg { stroke: #004d40; }
    .icon-btn.desasociar-btn:hover svg { stroke: #8e0c2f; }
    .modal { position:fixed; z-index:999; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.18); display:flex; align-items:center; justify-content:center;}
    .modal-content { background:#fff; padding:28px 22px 20px 22px; border-radius:14px; min-width:300px; max-width:400px; position:relative; box-shadow:0 2px 18px rgba(80,60,160,.18);}
    .close { position:absolute; right:12px; top:10px; font-size:20px; color:#7656b0; cursor:pointer;}
    .modal-content h4 { color:#381e60; margin-bottom:16px;}
    .modal-content input, .modal-content select { width:100%; margin-bottom:10px; }
    @media (max-width: 600px) {
      .container { max-width: 98vw; padding: 10px 5px 10px 5px; border-radius: 10px;}
      th, td { padding: 6px 2px; font-size:14px;}
    }
    .activo-tag {
      display: inline-block;
      min-width: 40px;
      text-align: center;
      font-weight: 500;
      font-size: 14px;
      border-radius: 12px;
      padding: 2px 8px;
      background: #e7e2fa;
      color: #7656b0;
    }
    .activo-tag.no { background: #ffe1e1; color: #B00020;}
  </style>
</head>
<body>
<div class="container">
  <h3>Asistentes</h3>
  <button type="button" id="crear-asistente-btn" class="btn primary" style="margin-bottom:20px;">Crear asistente</button>
  <table id="asistentes-table">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Email</th>
        <th>Centro M√©dico</th>
        <th>Activo</th>
        <th class="action-cell">Acciones</th>
      </tr>
    </thead>
    <tbody id="asistentes-tbody">
      <!-- Asistentes se mostrar√°n aqu√≠ -->
    </tbody>
  </table>
  <div id="status-msg" class="muted" style="margin-top:10px;"></div>
</div>

<!-- Modal para crear/editar asistente -->
<div id="modal-asistente" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" id="cerrar-modal-asistente">&times;</span>
    <h4 id="modal-title">Crear asistente</h4>
    <form id="form-asistente">
      <label for="display_name">Nombre:</label>
      <input type="text" id="display_name" required placeholder="Nombre completo">
      <label for="email">Email:</label>
      <input type="email" id="email" required placeholder="Email">
      <label for="password">Contrase√±a:</label>
      <input type="password" id="password" required placeholder="Contrase√±a">
      <label for="centro_id">Centro M√©dico:</label>
      <select id="centro_id" required>
        <option value="" disabled selected>Cargando centros...</option>
      </select>
      <label for="active">Activo:</label>
      <select id="active">
        <option value="true">S√≠</option>
        <option value="false">No</option>
      </select>
      <button type="submit" class="btn primary" style="margin-top:10px;">Guardar asistente</button>
      <div id="modal-asistente-status" class="muted" style="margin-top:10px;"></div>
    </form>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Demo: tabla de asistentes de prueba
  const asistentesDemo = [
    { nombre: 'Laura G√≥mez', email: 'laura@gmail.com', centro: 'Centro Norte', activo: true },
    { nombre: 'Juan P√©rez', email: 'juan@correo.com', centro: 'Centro Sur', activo: false }
  ];
  const tbody = document.getElementById('asistentes-tbody');
  const crearBtn = document.getElementById('crear-asistente-btn');
  const modal = document.getElementById('modal-asistente');
  const cerrarModal = document.getElementById('cerrar-modal-asistente');
  const form = document.getElementById('form-asistente');
  const modalStatus = document.getElementById('modal-asistente-status');
  const modalTitle = document.getElementById('modal-title');

  // Render tabla demo
  function renderTabla() {
    tbody.innerHTML = '';
    if(asistentesDemo.length === 0) {
      tbody.innerHTML = `<tr><td colspan="5" class="muted">No hay asistentes registrados a√∫n.</td></tr>`;
      return;
    }
    asistentesDemo.forEach((asistente, i) => {
      tbody.innerHTML += `
        <tr>
          <td>${asistente.nombre}</td>
          <td>${asistente.email}</td>
          <td>${asistente.centro}</td>
          <td>
            <span class="activo-tag${asistente.activo ? '' : ' no'}">
              ${asistente.activo ? 'S√≠' : 'No'}
            </span>
          </td>
          <td class="action-cell">
            <button class="icon-btn edit-btn" title="Editar" data-index="${i}">
              ‚úèÔ∏è
            </button>
            <button class="icon-btn delete-btn" title="Eliminar" data-index="${i}">
              üóëÔ∏è
            </button>
          </td>
        </tr>
      `;
    });

    // Acci√≥n editar
    Array.from(document.getElementsByClassName('edit-btn')).forEach(btn => {
      btn.onclick = function() {
        const idx = parseInt(btn.dataset.index, 10);
        editarAsistente(idx);
      }
    });
    // Acci√≥n eliminar
    Array.from(document.getElementsByClassName('delete-btn')).forEach(btn => {
      btn.onclick = function() {
        const idx = parseInt(btn.dataset.index, 10);
        if(confirm('¬øEliminar asistente?')) {
          asistentesDemo.splice(idx, 1);
          renderTabla();
        }
      }
    });
  }

  renderTabla();

  // Abrir modal crear asistente
  crearBtn.onclick = function() {
    form.reset();
    modalTitle.textContent = 'Crear asistente';
    modalStatus.textContent = '';
    modal.style.display = 'flex';
    document.getElementById('password').required = true;
  };
  cerrarModal.onclick = function() { modal.style.display = 'none'; };
  window.onclick = function(e) { if(e.target == modal) modal.style.display = 'none'; };

  // Guardar asistente (demo)
  form.onsubmit = function(e) {
    e.preventDefault();
    const nombre = document.getElementById('display_name').value.trim();
    const email = document.getElementById('email').value.trim();
    const centro = document.getElementById('centro_id').value || 'Centro Norte';
    const activo = document.getElementById('active').value === 'true';
    if(!nombre || !email || !centro) {
      modalStatus.textContent = 'Completa todos los campos.';
      return;
    }
    if(modalTitle.textContent === 'Crear asistente') {
      asistentesDemo.push({ nombre, email, centro, activo });
      modalStatus.textContent = '¬°Asistente creado!';
      renderTabla();
      setTimeout(()=>{modal.style.display='none'}, 800);
    } else {
      // Editar
      const idx = form.dataset.editIndex;
      if(idx !== undefined) {
        asistentesDemo[idx] = { nombre, email, centro, activo };
        modalStatus.textContent = '¬°Asistente editado!';
        renderTabla();
        setTimeout(()=>{modal.style.display='none'}, 800);
      }
      form.dataset.editIndex = '';
    }
  }

  // Demo: editar asistente
  function editarAsistente(idx) {
    const a = asistentesDemo[idx];
    if(!a) return;
    form.reset();
    document.getElementById('display_name').value = a.nombre;
    document.getElementById('email').value = a.email;
    document.getElementById('centro_id').value = a.centro;
    document.getElementById('active').value = a.activo ? 'true' : 'false';
    modalTitle.textContent = 'Editar asistente';
    modalStatus.textContent = '';
    modal.style.display = 'flex';
    form.dataset.editIndex = idx;
    document.getElementById('password').required = false;
  }

  // Demo: centros m√©dicos
  const centros = ['Centro Norte', 'Centro Sur', 'Centro Este'];
  const centroSelect = document.getElementById('centro_id');
  centroSelect.innerHTML = '<option value="" disabled selected>Seleccione centro m√©dico</option>' + centros.map(c=>`<option value="${c}">${c}</option>`).join('');
});
</script>
</body>
</html>
