<!-- Vista TURNOS (partial) - se inyecta dentro de #main-content -->
<div id="turnos-view" data-view="turnos">

  <!-- Toolbar -->
  <div class="tw-toolbar">
    <div class="tw-field">
      <label>Centro m√©dico</label>
      <select id="turnos-centro-select" class="tw-sel" style="display:none;"></select>
      <input id="turnos-centro-nombre" class="tw-inp" type="text" readonly style="display:none;">
    </div>
    <div class="tw-field">
      <label>Profesional</label>
      <select id="turnos-profesional-select" class="tw-sel">
        <option>Cargando...</option>
      </select>
    </div>
    <div class="tw-field">
      <label>Paciente</label>
      <input id="turnos-paciente-input" class="tw-inp" placeholder="Apellido Nombre o DNI" autocomplete="off">
      <div id="turnos-paciente-suggest" class="tw-suggest" style="display:none;"></div>
      <div id="turnos-paciente-chip" class="tw-chip" style="display:none;">
        <span id="turnos-paciente-chip-text"></span>
        <button id="turnos-paciente-clear" title="Quitar">‚úï</button>
      </div>
    </div>
    <div class="tw-field">
      <label>Tipo de turno</label>
      <select id="turnos-tipo" class="tw-sel">
        <option value="nueva_consulta">Nueva consulta</option>
        <option value="recurrente">Recurrente</option>
        <option value="sobreturno">Sobreturno</option>
      </select>
    </div>
    <div class="tw-field" style="align-items:flex-end">
      <button id="turnos-btn-hoy" class="tw-btn ghost">Hoy</button>
    </div>
  </div>

  <!-- Head -->
  <div class="tw-head">
    <div class="tw-head-left">
      <button id="turnos-prev-month" class="tw-btn secondary" title="Mes anterior">‚óÄ</button>
      <h2 id="turnos-cal-title">Calendario</h2>
      <button id="turnos-next-month" class="tw-btn secondary" title="Mes siguiente">‚ñ∂</button>
    </div>
    <div class="tw-legend">
      <span class="tw-dot free"></span> con disponibilidad 
      <span class="tw-dot busy"></span> sin hueco 
      <span class="tw-dot none"></span> sin agenda
    </div>
  </div>

  <!-- Calendario mensual -->
  <div class="tw-cal">
    <div class="tw-dow" id="turnos-cal-dow"></div>
    <div class="tw-grid" id="turnos-cal-grid"></div>
  </div>
  <div class="tw-status" id="turnos-status"></div>

</div> <!-- cierre de #turnos-view -->

<!-- Modal d√≠a -->
<div class="tw-backdrop" id="turnos-modal">
  <div class="tw-modal">
    <div class="tw-modal-header">
      <h3 id="turnos-modal-title" class="tw-modal-title">Turnos del d√≠a</h3>
      <div class="tw-day-nav">
        <button class="tw-icon-btn" id="turnos-modal-prev-day" data-tip="D√≠a anterior">‚óÄ</button>
        <input type="date" id="turnos-modal-date" class="tw-inp tw-date">
        <button class="tw-icon-btn" id="turnos-modal-next-day" data-tip="D√≠a siguiente">‚ñ∂</button>
        <!-- Mini calendario mensual dentro del modal -->
        <div id="turnos-mini-cal" class="tw-mini" aria-label="Disponibilidad del mes"></div>
      </div>
      <button class="tw-close" id="turnos-modal-close">√ó</button>
    </div>
    <section class="tw-slots">
      <h4>Horarios</h4>
      <div id="turnos-slots-list"></div>
    </section>
  </div>
</div>

<!-- Modal OK -->
<div class="tw-backdrop" id="turnos-modal-ok" style="display:none;">
  <div class="tw-modal-ok">
    <div class="tw-modal-header">
      <div class="tw-ok-head">
        <div class="tw-ok-badge">‚úî Turno asignado</div>
        <div id="ok-title" class="tw-ok-title"></div>
      </div>
      <button class="tw-close" id="ok-close">√ó</button>
    </div>
    <ul class="tw-ok-list">
      <li><b>Paciente:</b> <span id="ok-paciente"></span></li>
      <li><b>DNI:</b> <span id="ok-dni"></span></li>
      <li><b>Fecha y hora:</b> <span id="ok-fecha-hora"></span></li>
      <li><b>Profesional:</b> <span id="ok-prof"></span></li>
      <li><b>Centro:</b> <span id="ok-centro"></span></li>
      <li><b>Direcci√≥n:</b> <span id="ok-direccion"></span></li>
    </ul>
    <div class="tw-ok-actions">
      <a id="ok-wa-link" class="tw-btn ok" target="_blank" rel="noopener">Enviar por WhatsApp</a>
      <button id="ok-copy" class="tw-btn ghost">Copiar link</button>
      <span id="ok-msg" class="tw-hint"></span>
    </div>
  </div>
</div>

<!-- Modal Cupo agotado -->
<div id="modal-cupo-agotado" class="modal-cupo-agotado" style="display:none;">
  <div class="modal-content">
    <div class="modal-header-alert">
      <span class="icon-alert">‚ö†Ô∏è</span>
      <span class="modal-title">Cupo agotado para obra social</span>
    </div>
    <div class="modal-body">
      <p id="modal-cupo-msg">
        No quedan cupos disponibles para la obra social seleccionada.<br>
        ¬øDesea reservar el turno de forma <b>particular</b>?<br>
        El mismo tiene un costo de <b id="modal-cupo-copago">$0</b>.
      </p>
    </div>
    <div class="modal-actions">
      <button id="modal-cupo-aceptar" class="btn-accept">Aceptar</button>
      <button id="modal-cupo-cancelar" class="btn-cancel">Cancelar</button>
    </div>
  </div>
</div>

<!-- üÜï Modal Nuevo Paciente (versi√≥n fija con estilo moderno) -->
<div class="tw-backdrop" id="turnos-modal-paciente" style="display:none;">
  <div class="tw-modal tw-modal-wide">
    <div class="tw-modal-header">
      <h3 class="tw-modal-title">Nuevo Paciente</h3>
      <button id="turnos-modal-paciente-close" class="tw-close">√ó</button>
    </div>
    <div class="tw-grid3">
      <!-- Columna 1 -->
      <div class="tw-col">
        <h4>Datos personales</h4>
        <label>DNI<span class="tw-req">*</span></label>
        <input id="np-dni" class="tw-inp" type="text">

        <label>Nombre<span class="tw-req">*</span></label>
        <input id="np-nombre" class="tw-inp" type="text">

        <label>Apellido<span class="tw-req">*</span></label>
        <input id="np-apellido" class="tw-inp" type="text">

        <label>Fecha de nacimiento<span class="tw-req">*</span></label>
        <input id="np-fecha-nac" class="tw-inp" type="date">

        <label>Tel√©fono<span class="tw-req">*</span></label>
        <input id="np-telefono" class="tw-inp" type="text">

        <label>Email</label>
        <input id="np-email" class="tw-inp" type="email">
      </div>

      <!-- Columna 2 -->
      <div class="tw-col">
        <h4>Obra Social</h4>
        <label>Obra social</label>
        <select id="np-obra" class="tw-sel"></select>
        <div id="np-obra-info" class="tw-hint"></div>

        <label>N¬∞ Afiliado</label>
        <input id="np-afiliado" class="tw-inp" type="text">

        <h4 style="margin-top:14px;">Contacto de emergencia</h4>
        <label>Nombre</label>
        <input id="np-contacto-nombre" class="tw-inp" type="text">

        <label>Apellido</label>
        <input id="np-contacto-apellido" class="tw-inp" type="text">

        <label>Celular</label>
        <input id="np-contacto-cel" class="tw-inp" type="text">

        <label>V√≠nculo</label>
        <input id="np-vinculo" class="tw-inp" type="text">
      </div>

      <!-- Columna 3 -->
      <div class="tw-col tw-span3">
        <h4>Historia cl√≠nica</h4>
        <textarea id="np-historia" class="tw-inp" rows="5"></textarea>
        <a id="np-historia-open" href="#" class="tw-linklike">Abrir historia cl√≠nica</a>

        <h4 style="margin-top:14px;">Credencial</h4>
        <div class="tw-upload-zone">
          <button id="np-cred-select" class="tw-btn ghost">Subir credencial</button>
          <input id="np-cred-file" type="file" style="display:none;">
          <div id="np-cred-preview" class="tw-upload-preview" style="display:none;"></div>
        </div>

        <div class="tw-actions">
          <button id="turnos-guardar-paciente" class="tw-btn">Guardar paciente</button>
          <span id="turnos-np-msg" class="tw-hint"></span>
        </div>
      </div>
    </div>
  </div>
</div>



<!-- Enlaces a CSS y JS -->
<link rel="stylesheet" href="turnos.css">
<script type="module" src="turnos.js"></script>
