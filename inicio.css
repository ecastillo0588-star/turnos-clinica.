/* ===========================
   INICIO — EG Health Solutions
   =========================== */

/* ---------- Variables ---------- */
:root{
  --brand:#7656b0; --brand-2:#a490d7; --ink:#381e60; --muted:#6b6480;
  --bg:#f7f9fb; --card:#fff; --line:#ece5fc;
  --ok:#0a7d38; --warn:#8a5800; --danger:#d32f2f;

  /* Tipografía (controlada por A−/A/A+) */
  --fs:14px;

  /* Layout boards (JS ajusta estas dos) */
  --board-h:420px;
  --row-1:var(--board-h);
  --row-2:var(--board-h);

  /* Columnas y canal de Acciones */
  --w-acc:100px;       /* ancho fijo Acciones */
  --w-hora:110px; --w-dni:120px; --w-espera:90px; --w-copago:110px; --w-prof:220px;
  --minch-nombre:12ch; --minch-apellido:12ch; --minch-obra:10ch;
  --gap-acc:2px;
}

/* ----- Scope suave para no pelear con app.css ----- */
#inicio-root, #inicio-root *{ box-sizing:border-box; }
#inicio-root{ color:var(--ink); font-family:'Segoe UI', system-ui, Arial, sans-serif; font-size:var(--fs); }

/* Neutralizar card contenedora del shell */
:where(#main-content.card){
  max-width:none!important; width:100%!important; padding:0!important;
  background:transparent!important; box-shadow:none!important; border-radius:0!important;
}

/* ---------- Contenedor ---------- */
.shell{ padding:10px; }
#inicio-root.panel{
  background:var(--card); border-radius:12px; box-shadow:0 1px 10px rgba(80,60,160,.08);
  padding:10px; display:flex; flex-direction:column; gap:8px; min-height:calc(100vh - 20px);
}

/* ---------- Inputs / botones ---------- */
#inicio-root .field{ display:flex; flex-direction:column; gap:3px; min-width:0; }
#inicio-root .field label{ font-size:.85em; color:var(--muted); }
#inicio-root .inp, #inicio-root .sel{
  background:#f7f9fb; border:1px solid var(--line); border-radius:8px; padding:7px 9px; color:var(--ink); outline:none; width:100%;
}
#inicio-root .inp:focus, #inicio-root .sel:focus, #inicio-root textarea:focus{ border-color:var(--brand-2); }
#inicio-root .sel.compact{ max-width:240px; }
#inicio-root .btn{ appearance:none; border:none; background:var(--brand); color:#fff; border-radius:8px; padding:7px 10px; font-weight:600; cursor:pointer; }
#inicio-root .btn.secondary{ background:#e7e2fa; color:#5a3e9a; }

/* ---------- Chips ---------- */
#inicio-root .chip{
  display:flex; align-items:baseline; gap:6px; background:#f3f1fb; border:1px solid var(--line);
  padding:6px 9px; border-radius:999px; white-space:nowrap;
}
#inicio-root .chip .v{ font-size:1.05em; font-weight:800; line-height:1; }
#inicio-root .chip.mini{ font-size:.9em; padding:4px 8px; }

/* ---------- Toolbar ---------- */
#inicio-root .toolbar{
  display:grid;
  grid-template-columns: minmax(260px,1.4fr) minmax(180px,.9fr) minmax(160px,.8fr) auto auto;
  gap:10px 12px; align-items:end;
}
#inicio-root .toolbar-aux{ margin-left:auto; display:flex; align-items:end; gap:8px; flex-wrap:wrap; }
#inicio-root .search-wrap{ display:flex; align-items:center; gap:8px; width:fit-content; }
#inicio-root .search-wrap .inp{ height:36px; width:26ch; max-width:28ch; }
#inicio-root .search-clear{ border:none; background:#efeafb; border:1px solid var(--line); border-radius:8px; padding:6px 10px; cursor:pointer; }

#inicio-root .zoom-chip{ gap:6px; }
#inicio-root .zoom-chip.compact{
  gap:0; padding:2px; background:#fff; border:1px solid var(--line); border-radius:10px; display:inline-flex; align-items:center;
}
#inicio-root .zoom-btn{
  appearance:none; border:1px solid var(--line); background:#fff; padding:.25em .55em; border-radius:6px; cursor:pointer; font-weight:700; line-height:1; min-width:2.2em;
}
#inicio-root .zoom-chip.compact .zoom-btn{ border:0; background:transparent; padding:4px 8px; min-width:auto; }
#inicio-root .zoom-chip.compact .zoom-btn + .zoom-btn{ border-left:1px solid var(--line); }
#inicio-root .zoom-btn:hover{ background:#f4f1ff; }
#inicio-root .zoom-btn:focus-visible{ outline:2px solid var(--brand-2); outline-offset:2px; }

/* ---------- Boards grid ---------- */
#inicio-root .boards{
  display:grid; gap:12px; grid-template-columns:1fr 1fr;   /* 2×2 por defecto */
  grid-template-rows: var(--row-1) var(--row-2);
  min-height:0; position:relative;
}
#inicio-root .board{
  background:var(--card); border:1px solid var(--line); border-radius:10px;
  padding:10px; display:flex; flex-direction:column; min-height:0; overflow:hidden; position:relative;
}
#inicio-root .board h3{
  margin:2px 2px 8px; font-size:1.05rem; line-height:1.2; display:flex; align-items:center; gap:8px; color:#3b2b66;
  position:relative; padding-right:96px; min-height:34px;
}

/* Controles del board (centrados) */
#inicio-root .b-ctrls{ position:absolute; right:8px; top:50%; transform:translateY(-50%); display:inline-flex; gap:6px; z-index:40; }
#inicio-root .b-ctrl{
  border:none; background:#f4f1ff; border:1px solid var(--line);
  width:28px; height:28px; border-radius:7px; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:14px;
}
#inicio-root .b-ctrl:hover{ background:#e6defa; }
#inicio-root .b-ctrl:focus-visible{ outline:2px solid var(--brand-2); outline-offset:2px; }

/* Modo expandido */
#inicio-root .boards.fullmode > .board{ display:none; }
#inicio-root .boards.fullmode > .board.expanded{
  display:flex !important; position:absolute; inset:0; z-index:9; height:100%; width:100%; box-shadow:0 8px 40px rgba(0,0,0,.18);
}
#inicio-root .b-ctrl--collapse{ display:none; }
#inicio-root .board.expanded .b-ctrl--collapse{ display:flex; }

/* ---------- Tabla + encabezado + Acciones ---------- */
#inicio-root .board-body{
  position:relative; flex:1 1 auto; min-height:0;
  overflow-y:auto; overflow-x:auto;
  padding:0 calc(var(--w-acc) + var(--gap-acc)) 6px 2px;  /* reserva canal Acciones */
  overscroll-behavior:contain; -webkit-overflow-scrolling:touch;
  scrollbar-gutter:stable both-edges;
}

/* Evitar que app.css pegue thead en esta vista */
#inicio-root table thead th{ position:static !important; top:auto !important; z-index:auto !important; }

/* Encabezado sticky controlado por clase */
#inicio-root .thead{ position:sticky; top:0; z-index:2; background:#fff; }

/* Filas como grid (JS define grid-template-columns) */
#inicio-root .table{ width:100%; border-collapse:separate; border-spacing:0 5px; min-width:0; }
#inicio-root .hrow, #inicio-root .row{
  display:grid; gap:0; align-items:center; border:1px solid var(--line); padding:5px 8px; border-radius:8px; margin-right:0;
}
#inicio-root .hrow{ background:#f4f1ff; color:#5a3e9a; font-weight:700; }
#inicio-root .row{ background:#faf9ff; }
#inicio-root .cell{ padding:0 4px; min-width:0; }
#inicio-root .right{ text-align:right; }
#inicio-root .nowrap{ white-space:nowrap; }
#inicio-root .truncate{ overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }
#inicio-root .thead .hrow .cell{ white-space:nowrap; }

/* Acciones SIEMPRE visibles (anclaje robusto) */
#inicio-root .hrow .cell:last-child,
#inicio-root .row  .cell:last-child{
  position:sticky;
  left: calc(100% - var(--w-acc));   /* pegado al borde derecho del scrollport */
  right: auto !important;
  z-index:3;
  min-width:var(--w-acc); max-width:var(--w-acc); width:var(--w-acc);
  border-left:1px solid var(--line);
  will-change:left;
  contain:layout paint;
}
#inicio-root .row .cell:last-child{
  background:
    linear-gradient(to left, #faf9ff 32px, rgba(250,249,255,0)),
    #faf9ff;
}
#inicio-root .thead .hrow .cell:last-child{
  z-index:4;
  background:
    linear-gradient(to left, #f4f1ff 32px, rgba(244,241,255,0)),
    #f4f1ff;
}

#inicio-root .actions{ display:flex; gap:6px; justify-content:flex-end; }
#inicio-root .icon{
  border:none; background:#f4f1ff; border:1px solid var(--line);
  width:28px; height:28px; border-radius:7px; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:14px;
}

/* Badges */
#inicio-root .wait{ display:inline-block; font-size:.85em; padding:2px 7px; border-radius:999px; background:#fff4e6; border:1px solid #ffe0b3; color:#8a5800; }
#inicio-root .copago{ display:inline-block; font-size:.85em; padding:2px 7px; border-radius:999px; background:#e8fff0; border:1px solid #b9f0cb; color:#0a7d38; }
#inicio-root .copago.none{ background:#f1f1f1; border-color:#e0e0e0; color:#666; }

/* ---------- Ocultaciones por rol ---------- */
body.role-amc [data-act="cancel"],
body.role-amc [data-act="atender"],
body.role-amc [data-act="abrir-ficha"],
body.role-amc [data-act="finalizar"]{ display:none !important; }

/* ---------- Drawer ---------- */
#inicio-root .drawer{
  position:fixed; top:0; right:0; height:100vh; width:min(980px,96vw);
  background:#fff; border-left:1px solid var(--line); box-shadow:-12px 0 40px rgba(0,0,0,.18);
  transform:translateX(100%); transition:transform .28s ease; z-index:9999; display:flex; flex-direction:column;
}
#inicio-root .drawer.open{ transform:translateX(0); }
#inicio-root .drawer-head{ display:flex; align-items:center; gap:10px; padding:10px 12px; background:#e8def8; border-bottom:1px solid var(--line); }
#inicio-root .drawer-title{ margin:0; font-weight:800; }
#inicio-root .drawer-sub{ color:#6b6480; }
#inicio-root .drawer-body{ flex:1; overflow:auto; padding:12px; }
#inicio-root .drawer-foot{ padding:10px 12px; border-top:1px solid var(--line); background:#faf7ff; display:flex; gap:10px; justify-content:flex-end; }
#inicio-root .msg{ font-size:1em; }
#inicio-root .ok{ color:var(--ok); }  #inicio-root .warn{ color:var(--warn); }
#inicio-root .row2{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
#inicio-root .row3{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; }
#inicio-root .card{ background:#fff; border:1px solid var(--line); border-radius:12px; padding:14px; margin-bottom:12px; }
#inicio-root .card h4{ margin:0 0 10px 0; font-size:1em; color:#4b3a78; }

#inicio-root .hc-link{
  display:inline-flex; align-items:center; gap:6px; font-weight:600; text-decoration:none;
  color:#3b2b66; background:#ffffff; border:1px solid #cbbbe8; padding:6px 10px; border-radius:8px; box-shadow:0 1px 0 rgba(0,0,0,.05);
}
#inicio-root .hc-link:hover{ background:#fff; border-color:#b6a3ea; box-shadow:0 2px 6px rgba(0,0,0,.08); }
#inicio-root .hc-link:focus-visible{ outline:2px solid var(--brand-2); outline-offset:2px; }
#inicio-root .hc-link.hc-link-big{ font-size:.98rem; padding:8px 12px; }

#fichaDrawer .drawer-foot #fd-finalizar{ background:#d32f2f !important; border-color:#b71c1c !important; color:#fff !important; }
#fichaDrawer .drawer-foot #fd-finalizar:hover{ background:#b71c1c !important; }
#fichaDrawer .drawer-foot #fd-finalizar:focus-visible{ outline:2px solid #7f1d1d; outline-offset:2px; }

/* Resumen del drawer: mostrar solo Hora turno y Copago */
#fd-prof, #fd-centro, #fd-fecha, #fd-estado{ display:none !important; }

/* ----- Resumen (chips) en una sola línea ----- */
#inicio-root #fd-summary{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:nowrap;          /* no se parte de línea */
  overflow-x:auto;           /* si no entra, scroll horizontal suave */
  scrollbar-gutter:stable;   /* evita “saltitos” al aparecer el scroll */
  padding-bottom:2px;        /* un pelín de aire para el scroll */
}
#inicio-root #fd-summary .chip{
  display:inline-flex;       /* no ocupar ancho completo */
  flex:0 0 auto;             /* no crecer, no encoger */
  white-space:nowrap;        /* todo el contenido en una línea */
}


/* ---------- Responsive ---------- */

/* Objetivo: a zoom 100% no haya scroll horizontal → 1 columna <=1500px */
@media (max-width:1500px){
  #inicio-root .boards{ grid-template-columns:1fr; grid-template-rows:auto auto auto auto; }
}

/* Toolbar a 2 filas en móviles */
@media (max-width:700px){
  #inicio-root .toolbar{ grid-template-columns:1fr 1fr; }
  #inicio-root .toolbar-aux{ grid-column:1 / -1; justify-content:flex-start; }
  #inicio-root .search-wrap{ width:100%; }
  #inicio-root .search-wrap .inp{ width:100%; max-width:100%; }
}

/* Afinado cuando hay 2×2 (>1500px): compactar sutilmente para que todo entre sin scroll */
@media (min-width:1500px){
  :root{
    --w-acc:96px; --w-hora:100px; --w-dni:112px; --w-espera:84px; --w-copago:104px; --w-prof:200px;
    --minch-nombre:10ch; --minch-apellido:10ch; --minch-obra:9ch;
  }
  #inicio-root .board{ padding:8px; }
  #inicio-root .hrow, #inicio-root .row{ padding:4px 6px; }
  #inicio-root .cell{ padding:0 3px; }
}

/* Deshabilitar "grow" en 1 columna */
@media (max-width:1500px){
  #inicio-root .b-ctrl--grow{ opacity:.5; pointer-events:none; }
}
/* === Panel lateral de turno (off-canvas) === */
.turno-panel{
  position: fixed;
  right: 0;
  top: 0;
  width: 420px;
  max-width: 92vw;
  height: 100vh;
  background: #fff;
  box-shadow: -28px 0 44px rgba(0,0,0,.18);
  transform: translateX(110%);
  opacity: 0;
  transition: transform .24s ease, opacity .24s ease;
  z-index: 60;
  overflow: auto;
  border-top-left-radius: 12px;
  border-bottom-left-radius: 12px;
}
@media (min-width:1100px){
  .turno-panel{
    top: 64px;                  /* altura aprox. de la toolbar */
    height: calc(100vh - 64px);
  }
}
.turno-panel.open{
  transform: translateX(0);
  opacity: 1;
}
/* opcional: bloquear scroll del fondo cuando está abierto */
body.tp-open{ overflow: hidden; }

/* Fuerzo el panel de turno a salir desde la derecha */
#inicio-root aside.turno-panel{
  left: auto !important;
  right: 0 !important;
  transform: translateX(110%) !important;
}
#inicio-root aside.turno-panel.open{
  transform: translateX(0) !important;
}



/* === Turno panel: look & feel tipo ficha === */
.turno-panel .tp-section{ padding:12px; border-bottom:1px solid var(--line); }
.turno-panel .tp-head{
  position:sticky; top:0; z-index:2;
  padding:10px 12px; background:#e8def8; border-bottom:1px solid var(--line);
}
.turno-panel .tp-title{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.turno-panel .tp-title h3{ margin:0; font-weight:800; color:#3b2b66; }
.turno-panel .tp-sub{ margin-top:2px; color:var(--muted); display:flex; gap:8px; align-items:center; }
.turno-panel .tp-h4{ margin:0 0 6px 0; font-size:.95rem; color:#4b3a78; }
.turno-panel .tp-chips{ display:flex; gap:8px; flex-wrap:wrap; margin-top:6px; }
.turno-panel .tp-actions{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
.turno-panel .tp-row{ display:flex; align-items:center; justify-content:space-between; gap:10px; }

/* Botón de cerrar del head */
.turno-panel .icon-btn{
  appearance:none; border:1px solid var(--line); background:#fff;
  width:28px; height:28px; border-radius:7px; cursor:pointer; display:flex; align-items:center; justify-content:center;
}
.turno-panel .icon-btn:hover{ background:#f4f1ff; }

/* Botón ghost (Abrir ficha / Guardar comentario) */
.btn.ghost{
  background:#fff; color:#3b2b66; border:1px solid var(--line);
}
.btn.ghost:hover{ background:#f7f4ff; }

/* Tonos de chips (se aplican desde JS con setChip(..., tone)) */
.chip.info{   background:#eef4ff; border-color:#d8e6ff; color:#254b7a; }
.chip.accent{ background:#efeafb; border-color:#e0d6fb; color:#5a3e9a; }
.chip.warn{   background:#fff4e6; border-color:#ffe0b3; color:#8a5800; }
.chip.ok{     background:#e8fff0; border-color:#b9f0cb; color:#0a7d38; }
.chip.muted{  background:#f1f1f4; border-color:#e5e5ee; color:#6b6480; }

/* Tarjetita de resumen de pago dentro del panel */
#tp-copago-info{
  background:#faf9ff; border:1px dashed var(--line);
  padding:8px 10px; border-radius:8px; color:#3b2b66;
}

/* Inputs del panel (matching del resto) */
.turno-panel .inp, .turno-panel .sel, .turno-panel textarea{
  width:100%; background:#f7f9fb; border:1px solid var(--line); border-radius:8px; padding:7px 9px; color:#var(--ink);
}
.turno-panel textarea{ min-height:76px; resize:vertical; }
.turno-panel .inp:focus, .turno-panel .sel:focus, .turno-panel textarea:focus{
  border-color:var(--brand-2); outline:none;
}
